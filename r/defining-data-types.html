<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Defining Data Types | Arrow Cookbook</title>
  <meta name="description" content="4 Defining Data Types | Arrow Cookbook" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Defining Data Types | Arrow Cookbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Defining Data Types | Arrow Cookbook" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-arrow-objects.html"/>
<link rel="next" href="manipulating-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html"><i class="fa fa-check"></i><b>2</b> Reading and Writing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#converting-from-a-data-frame-to-an-arrow-table"><i class="fa fa-check"></i><b>2.1</b> Converting from a data frame to an Arrow Table</a><ul>
<li class="chapter" data-level="2.1.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution"><i class="fa fa-check"></i><b>2.1.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#converting-data-from-an-arrow-table-to-a-data-frame"><i class="fa fa-check"></i><b>2.2</b> Converting data from an Arrow Table to a data frame</a><ul>
<li class="chapter" data-level="2.2.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-1"><i class="fa fa-check"></i><b>2.2.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#writing-a-parquet-file"><i class="fa fa-check"></i><b>2.3</b> Writing a Parquet file</a><ul>
<li class="chapter" data-level="2.3.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-2"><i class="fa fa-check"></i><b>2.3.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-a-parquet-file"><i class="fa fa-check"></i><b>2.4</b> Reading a Parquet file</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-3"><i class="fa fa-check"></i><b>2.4.1</b> Solution</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion"><i class="fa fa-check"></i><b>2.4.2</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-a-parquet-file-from-s3"><i class="fa fa-check"></i><b>2.5</b> Read a Parquet file from S3</a><ul>
<li class="chapter" data-level="2.5.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-4"><i class="fa fa-check"></i><b>2.5.1</b> Solution</a></li>
<li class="chapter" data-level="2.5.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#see-also"><i class="fa fa-check"></i><b>2.5.2</b> See also</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#filter-columns-while-reading-a-parquet-file"><i class="fa fa-check"></i><b>2.6</b> Filter columns while reading a Parquet file</a><ul>
<li class="chapter" data-level="2.6.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-5"><i class="fa fa-check"></i><b>2.6.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-an-ipcfeather-v2-file"><i class="fa fa-check"></i><b>2.7</b> Write an IPC/Feather V2 file</a><ul>
<li class="chapter" data-level="2.7.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-6"><i class="fa fa-check"></i><b>2.7.1</b> Solution</a></li>
<li class="chapter" data-level="2.7.2" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#discussion-1"><i class="fa fa-check"></i><b>2.7.2</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-a-feather-file"><i class="fa fa-check"></i><b>2.8</b> Read a Feather file</a><ul>
<li class="chapter" data-level="2.8.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-7"><i class="fa fa-check"></i><b>2.8.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-streaming-ipc-files"><i class="fa fa-check"></i><b>2.9</b> Write Streaming IPC Files</a><ul>
<li class="chapter" data-level="2.9.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-8"><i class="fa fa-check"></i><b>2.9.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-streaming-ipc-files"><i class="fa fa-check"></i><b>2.10</b> Read Streaming IPC Files</a><ul>
<li class="chapter" data-level="2.10.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-9"><i class="fa fa-check"></i><b>2.10.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-and-writing-csv-files"><i class="fa fa-check"></i><b>2.11</b> Reading and Writing CSV files</a></li>
<li class="chapter" data-level="2.12" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#read-json-files"><i class="fa fa-check"></i><b>2.12</b> Read JSON files</a><ul>
<li class="chapter" data-level="2.12.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-10"><i class="fa fa-check"></i><b>2.12.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#write-partitioned-data"><i class="fa fa-check"></i><b>2.13</b> Write Partitioned Data</a><ul>
<li class="chapter" data-level="2.13.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-11"><i class="fa fa-check"></i><b>2.13.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#reading-partitioned-data"><i class="fa fa-check"></i><b>2.14</b> Reading Partitioned Data</a><ul>
<li class="chapter" data-level="2.14.1" data-path="reading-and-writing-data.html"><a href="reading-and-writing-data.html#solution-12"><i class="fa fa-check"></i><b>2.14.1</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html"><i class="fa fa-check"></i><b>3</b> Creating Arrow Objects</a><ul>
<li class="chapter" data-level="3.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#create-an-arrow-array-from-an-r-object"><i class="fa fa-check"></i><b>3.1</b> Create an Arrow Array from an R object</a><ul>
<li class="chapter" data-level="3.1.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-13"><i class="fa fa-check"></i><b>3.1.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#create-a-arrow-table-from-an-r-object"><i class="fa fa-check"></i><b>3.2</b> Create a Arrow Table from an R object</a><ul>
<li class="chapter" data-level="3.2.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-14"><i class="fa fa-check"></i><b>3.2.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#view-the-contents-of-an-arrow-table-or-recordbatch"><i class="fa fa-check"></i><b>3.3</b> View the contents of an Arrow Table or RecordBatch</a><ul>
<li class="chapter" data-level="3.3.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-15"><i class="fa fa-check"></i><b>3.3.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#manually-create-a-recordbatch-from-an-r-object."><i class="fa fa-check"></i><b>3.4</b> Manually create a RecordBatch from an R object.</a><ul>
<li class="chapter" data-level="3.4.1" data-path="creating-arrow-objects.html"><a href="creating-arrow-objects.html#solution-16"><i class="fa fa-check"></i><b>3.4.1</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="defining-data-types.html"><a href="defining-data-types.html"><i class="fa fa-check"></i><b>4</b> Defining Data Types</a><ul>
<li class="chapter" data-level="4.1" data-path="defining-data-types.html"><a href="defining-data-types.html#update-the-data-type-of-an-existing-arrow-array"><i class="fa fa-check"></i><b>4.1</b> Update the data type of an existing Arrow Array</a><ul>
<li class="chapter" data-level="4.1.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-17"><i class="fa fa-check"></i><b>4.1.1</b> Solution</a></li>
<li class="chapter" data-level="4.1.2" data-path="defining-data-types.html"><a href="defining-data-types.html#discussion-2"><i class="fa fa-check"></i><b>4.1.2</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="defining-data-types.html"><a href="defining-data-types.html#update-the-data-type-of-a-field-in-an-existing-arrow-table"><i class="fa fa-check"></i><b>4.2</b> Update the data type of a field in an existing Arrow Table</a><ul>
<li class="chapter" data-level="4.2.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-18"><i class="fa fa-check"></i><b>4.2.1</b> Solution</a></li>
<li class="chapter" data-level="4.2.2" data-path="defining-data-types.html"><a href="defining-data-types.html#no-compat-type"><i class="fa fa-check"></i><b>4.2.2</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="defining-data-types.html"><a href="defining-data-types.html#specify-data-types-when-creating-an-arrow-table-from-an-r-object"><i class="fa fa-check"></i><b>4.3</b> Specify data types when creating an Arrow table from an R object</a><ul>
<li class="chapter" data-level="4.3.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-19"><i class="fa fa-check"></i><b>4.3.1</b> Solution</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="defining-data-types.html"><a href="defining-data-types.html#specify-data-types-when-reading-in-files"><i class="fa fa-check"></i><b>4.4</b> Specify data types when reading in files</a><ul>
<li class="chapter" data-level="4.4.1" data-path="defining-data-types.html"><a href="defining-data-types.html#solution-20"><i class="fa fa-check"></i><b>4.4.1</b> Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-data.html"><a href="manipulating-data.html"><i class="fa fa-check"></i><b>5</b> Manipulating Data</a><ul>
<li class="chapter" data-level="5.1" data-path="manipulating-data.html"><a href="manipulating-data.html#computing-meanminmax-etc-value-of-an-array"><i class="fa fa-check"></i><b>5.1</b> Computing Mean/Min/Max, etc value of an Array</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-data.html"><a href="manipulating-data.html#counting-occurrences-of-elements-in-an-array"><i class="fa fa-check"></i><b>5.2</b> Counting occurrences of elements in an Array</a></li>
<li class="chapter" data-level="5.3" data-path="manipulating-data.html"><a href="manipulating-data.html#applying-arithmetic-functions-to-arrays."><i class="fa fa-check"></i><b>5.3</b> Applying arithmetic functions to Arrays.</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Arrow Cookbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="defining-data-types" class="section level1">
<h1><span class="header-section-number">4</span> Defining Data Types</h1>
<p>As discussed in previous chapters, Arrow automatically infers the most
appropriate data type when reading in data or converting R objects to Arrow
objects. However, you might want to manually tell Arrow which data types to
use, for example, to ensure interoperability with databases and data warehouse
systems. This chapter includes recipes for:</p>
<ul>
<li>changing the data types of existing Arrow objects</li>
<li>defining data types during the process of creating Arrow objects</li>
</ul>
<p>A table showing the default mappings between R and Arrow data types can be found
in <a href="https://arrow.apache.org/docs/r/articles/arrow.html#r-to-arrow">R data type to Arrow data type mappings</a>.</p>
<p>A table containing Arrow data types, and their R equivalents can be found in
<a href="https://arrow.apache.org/docs/r/articles/arrow.html#arrow-to-r">Arrow data type to R data type mapping</a>.</p>
<div id="update-the-data-type-of-an-existing-arrow-array" class="section level2">
<h2><span class="header-section-number">4.1</span> Update the data type of an existing Arrow Array</h2>
<p>You want to change the data type of an existing Arrow Array.</p>
<div id="solution-17" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Solution</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="defining-data-types.html#cb43-1"></a><span class="co"># Create an Array to cast</span></span>
<span id="cb43-2"><a href="defining-data-types.html#cb43-2"></a>integer_arr &lt;-<span class="st"> </span>Array<span class="op">$</span><span class="kw">create</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb43-3"><a href="defining-data-types.html#cb43-3"></a></span>
<span id="cb43-4"><a href="defining-data-types.html#cb43-4"></a><span class="co"># Cast to an unsigned int8 type</span></span>
<span id="cb43-5"><a href="defining-data-types.html#cb43-5"></a>uint_arr &lt;-<span class="st"> </span>integer_arr<span class="op">$</span><span class="kw">cast</span>(<span class="dt">target_type =</span> <span class="kw">uint8</span>())</span>
<span id="cb43-6"><a href="defining-data-types.html#cb43-6"></a></span>
<span id="cb43-7"><a href="defining-data-types.html#cb43-7"></a>uint_arr</span></code></pre></div>
<pre><code>## Array
## &lt;uint8&gt;
## [
##   1,
##   2,
##   3,
##   4,
##   5
## ]</code></pre>
</div>
<div id="discussion-2" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Discussion</h3>
<p>There are some data types which are not compatible with each other. Errors will
occur if you try to cast between incompatible data types.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="defining-data-types.html#cb45-1"></a>int_arr &lt;-<span class="st"> </span>Array<span class="op">$</span><span class="kw">create</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb45-2"><a href="defining-data-types.html#cb45-2"></a>int_arr<span class="op">$</span><span class="kw">cast</span>(<span class="dt">target_type =</span> <span class="kw">binary</span>())</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="defining-data-types.html#cb46-1"></a><span class="co">## Error: NotImplemented: Unsupported cast from int32 to binary using function cast_binary</span></span></code></pre></div>
</div>
</div>
<div id="update-the-data-type-of-a-field-in-an-existing-arrow-table" class="section level2">
<h2><span class="header-section-number">4.2</span> Update the data type of a field in an existing Arrow Table</h2>
<p>You want to change the type of one or more fields in an existing Arrow Table.</p>
<div id="solution-18" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Solution</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="defining-data-types.html#cb47-1"></a><span class="co"># Set up a tibble to use in this example</span></span>
<span id="cb47-2"><a href="defining-data-types.html#cb47-2"></a>oscars &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb47-3"><a href="defining-data-types.html#cb47-3"></a>  <span class="dt">actor =</span> <span class="kw">c</span>(<span class="st">&quot;Katharine Hepburn&quot;</span>, <span class="st">&quot;Meryl Streep&quot;</span>, <span class="st">&quot;Jack Nicholson&quot;</span>),</span>
<span id="cb47-4"><a href="defining-data-types.html#cb47-4"></a>  <span class="dt">num_awards =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb47-5"><a href="defining-data-types.html#cb47-5"></a>)</span>
<span id="cb47-6"><a href="defining-data-types.html#cb47-6"></a></span>
<span id="cb47-7"><a href="defining-data-types.html#cb47-7"></a><span class="co"># Convert tibble to an Arrow table</span></span>
<span id="cb47-8"><a href="defining-data-types.html#cb47-8"></a>oscars_arrow &lt;-<span class="st"> </span>Table<span class="op">$</span><span class="kw">create</span>(oscars)</span>
<span id="cb47-9"><a href="defining-data-types.html#cb47-9"></a></span>
<span id="cb47-10"><a href="defining-data-types.html#cb47-10"></a><span class="co"># The default mapping from numeric column &quot;num_awards&quot; is to a double</span></span>
<span id="cb47-11"><a href="defining-data-types.html#cb47-11"></a>oscars_arrow</span></code></pre></div>
<pre><code>## Table
## 3 rows x 2 columns
## $actor &lt;string&gt;
## $num_awards &lt;double&gt;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="defining-data-types.html#cb49-1"></a><span class="co"># Set up schema with &quot;num_awards&quot; as integer</span></span>
<span id="cb49-2"><a href="defining-data-types.html#cb49-2"></a>oscars_schema &lt;-<span class="st"> </span><span class="kw">schema</span>(<span class="dt">actor =</span> <span class="kw">string</span>(), <span class="dt">num_awards =</span> <span class="kw">int16</span>())</span>
<span id="cb49-3"><a href="defining-data-types.html#cb49-3"></a></span>
<span id="cb49-4"><a href="defining-data-types.html#cb49-4"></a><span class="co"># Cast to an int16</span></span>
<span id="cb49-5"><a href="defining-data-types.html#cb49-5"></a>oscars_arrow_int &lt;-<span class="st"> </span>oscars_arrow<span class="op">$</span><span class="kw">cast</span>(<span class="dt">target_schema =</span> oscars_schema)</span>
<span id="cb49-6"><a href="defining-data-types.html#cb49-6"></a></span>
<span id="cb49-7"><a href="defining-data-types.html#cb49-7"></a>oscars_arrow_int</span></code></pre></div>
<pre><code>## Table
## 3 rows x 2 columns
## $actor &lt;string&gt;
## $num_awards &lt;int16&gt;</code></pre>
</div>
<div id="no-compat-type" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Discussion</h3>
<p>There are some Arrow data types which do not have any R equivalent. Attempting
to cast to these data types or using a schema which contains them will result in
an error.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="defining-data-types.html#cb51-1"></a><span class="co"># Set up a tibble to use in this example</span></span>
<span id="cb51-2"><a href="defining-data-types.html#cb51-2"></a>oscars &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb51-3"><a href="defining-data-types.html#cb51-3"></a>  <span class="dt">actor =</span> <span class="kw">c</span>(<span class="st">&quot;Katharine Hepburn&quot;</span>, <span class="st">&quot;Meryl Streep&quot;</span>, <span class="st">&quot;Jack Nicholson&quot;</span>),</span>
<span id="cb51-4"><a href="defining-data-types.html#cb51-4"></a>  <span class="dt">num_awards =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb51-5"><a href="defining-data-types.html#cb51-5"></a>)</span>
<span id="cb51-6"><a href="defining-data-types.html#cb51-6"></a></span>
<span id="cb51-7"><a href="defining-data-types.html#cb51-7"></a><span class="co"># Convert tibble to an Arrow table</span></span>
<span id="cb51-8"><a href="defining-data-types.html#cb51-8"></a>oscars_arrow &lt;-<span class="st"> </span>Table<span class="op">$</span><span class="kw">create</span>(oscars)</span>
<span id="cb51-9"><a href="defining-data-types.html#cb51-9"></a></span>
<span id="cb51-10"><a href="defining-data-types.html#cb51-10"></a><span class="co"># Set up schema with &quot;num_awards&quot; as float16 which doesn&#39;t have an R equivalent</span></span>
<span id="cb51-11"><a href="defining-data-types.html#cb51-11"></a>oscars_schema_invalid &lt;-<span class="st"> </span><span class="kw">schema</span>(<span class="dt">actor =</span> <span class="kw">string</span>(), <span class="dt">num_awards =</span> <span class="kw">float16</span>())</span>
<span id="cb51-12"><a href="defining-data-types.html#cb51-12"></a></span>
<span id="cb51-13"><a href="defining-data-types.html#cb51-13"></a><span class="co"># The default mapping from numeric column &quot;num_awards&quot; is to a double</span></span>
<span id="cb51-14"><a href="defining-data-types.html#cb51-14"></a>oscars_arrow<span class="op">$</span><span class="kw">cast</span>(<span class="dt">target_schema =</span> oscars_schema_invalid)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="defining-data-types.html#cb52-1"></a><span class="co">## Error: NotImplemented: Unsupported cast from double to halffloat using function cast_half_float</span></span></code></pre></div>
</div>
</div>
<div id="specify-data-types-when-creating-an-arrow-table-from-an-r-object" class="section level2">
<h2><span class="header-section-number">4.3</span> Specify data types when creating an Arrow table from an R object</h2>
<p>You want to manually specify Arrow data types when converting an object from a
data frame to an Arrow object.</p>
<div id="solution-19" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Solution</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="defining-data-types.html#cb53-1"></a><span class="co"># Set up a tibble to use in this example</span></span>
<span id="cb53-2"><a href="defining-data-types.html#cb53-2"></a>oscars &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb53-3"><a href="defining-data-types.html#cb53-3"></a>  <span class="dt">actor =</span> <span class="kw">c</span>(<span class="st">&quot;Katharine Hepburn&quot;</span>, <span class="st">&quot;Meryl Streep&quot;</span>, <span class="st">&quot;Jack Nicholson&quot;</span>),</span>
<span id="cb53-4"><a href="defining-data-types.html#cb53-4"></a>  <span class="dt">num_awards =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb53-5"><a href="defining-data-types.html#cb53-5"></a>)</span>
<span id="cb53-6"><a href="defining-data-types.html#cb53-6"></a></span>
<span id="cb53-7"><a href="defining-data-types.html#cb53-7"></a><span class="co"># Set up schema with &quot;num_awards&quot; as integer</span></span>
<span id="cb53-8"><a href="defining-data-types.html#cb53-8"></a>oscars_schema &lt;-<span class="st"> </span><span class="kw">schema</span>(<span class="dt">actor =</span> <span class="kw">string</span>(), <span class="dt">num_awards =</span> <span class="kw">int16</span>())</span>
<span id="cb53-9"><a href="defining-data-types.html#cb53-9"></a></span>
<span id="cb53-10"><a href="defining-data-types.html#cb53-10"></a><span class="co"># create arrow Table containing data and schema</span></span>
<span id="cb53-11"><a href="defining-data-types.html#cb53-11"></a>oscars_data_arrow &lt;-<span class="st"> </span>Table<span class="op">$</span><span class="kw">create</span>(oscars, <span class="dt">schema =</span> oscars_schema)</span>
<span id="cb53-12"><a href="defining-data-types.html#cb53-12"></a></span>
<span id="cb53-13"><a href="defining-data-types.html#cb53-13"></a>oscars_data_arrow</span></code></pre></div>
<pre><code>## Table
## 3 rows x 2 columns
## $actor &lt;string&gt;
## $num_awards &lt;int16&gt;</code></pre>
</div>
</div>
<div id="specify-data-types-when-reading-in-files" class="section level2">
<h2><span class="header-section-number">4.4</span> Specify data types when reading in files</h2>
<p>You want to manually specify Arrow data types when reading in files.</p>
<div id="solution-20" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Solution</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="defining-data-types.html#cb55-1"></a><span class="co"># Set up a tibble to use in this example</span></span>
<span id="cb55-2"><a href="defining-data-types.html#cb55-2"></a>oscars &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb55-3"><a href="defining-data-types.html#cb55-3"></a>  <span class="dt">actor =</span> <span class="kw">c</span>(<span class="st">&quot;Katharine Hepburn&quot;</span>, <span class="st">&quot;Meryl Streep&quot;</span>, <span class="st">&quot;Jack Nicholson&quot;</span>),</span>
<span id="cb55-4"><a href="defining-data-types.html#cb55-4"></a>  <span class="dt">num_awards =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb55-5"><a href="defining-data-types.html#cb55-5"></a>)</span>
<span id="cb55-6"><a href="defining-data-types.html#cb55-6"></a></span>
<span id="cb55-7"><a href="defining-data-types.html#cb55-7"></a><span class="co"># write dataset to disk</span></span>
<span id="cb55-8"><a href="defining-data-types.html#cb55-8"></a><span class="kw">write_dataset</span>(oscars, <span class="dt">path =</span> <span class="st">&quot;oscars_data&quot;</span>)</span>
<span id="cb55-9"><a href="defining-data-types.html#cb55-9"></a></span>
<span id="cb55-10"><a href="defining-data-types.html#cb55-10"></a><span class="co"># Set up schema with &quot;num_awards&quot; as integer</span></span>
<span id="cb55-11"><a href="defining-data-types.html#cb55-11"></a>oscars_schema &lt;-<span class="st"> </span><span class="kw">schema</span>(<span class="dt">actor =</span> <span class="kw">string</span>(), <span class="dt">num_awards =</span> <span class="kw">int16</span>())</span>
<span id="cb55-12"><a href="defining-data-types.html#cb55-12"></a></span>
<span id="cb55-13"><a href="defining-data-types.html#cb55-13"></a><span class="co"># read the dataset in, using the schema instead of inferring the type automatically</span></span>
<span id="cb55-14"><a href="defining-data-types.html#cb55-14"></a>oscars_dataset_arrow &lt;-<span class="st"> </span><span class="kw">open_dataset</span>(<span class="st">&quot;oscars_data&quot;</span>, <span class="dt">schema =</span> oscars_schema)</span>
<span id="cb55-15"><a href="defining-data-types.html#cb55-15"></a></span>
<span id="cb55-16"><a href="defining-data-types.html#cb55-16"></a>oscars_dataset_arrow</span></code></pre></div>
<pre><code>## FileSystemDataset with 1 Parquet file
## actor: string
## num_awards: int16</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-arrow-objects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="manipulating-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/apache/arrow-cookbook/edit/main/r/content/specify_data_types_and_schemas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
